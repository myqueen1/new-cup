<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>管理员回复</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <base href="__PUBLIC__/backend/"/>
    <link href="style/adminStyle.css" rel="stylesheet" type="text/css"/>
    <script src="js/jquery.js"></script>
    <script src="js/public.js"></script>
</head>
<body>
<div class="wrap">
    <div class="page-title">
        <span class="modular fl"><i class="user"></i><em>管理员回复</em></span>
    </div>
    <dl>
        <dt class="R-userTitle">{$list.user_nickname}:</dt>
        <dd class="R-userCont">{$list.question}</dd>
        <dt class="R-adminTitle">管理员</dt>
        <dt style="display: none" class="leave_id">{$list.id}</dt>
        <if condition="$list.answer eq '' ">
                <dd class="R-adminCont answer" style="height: 50px">{$list.answer}</dd>
            <else/>
                <dd class="R-adminCont answer" style="height: 50px">{$list.answer}</dd>
        </if>
    </dl>


        <if condition="$list.answer eq '' ">

                <div class="con">
                    <hr/>
                    <textarea class="textarea block" style="padding:1em;"></textarea>
                    <input type="button" value="回复 " class="tdBtn" style="margin:8px 0;"/>
                </div>
            <else/>
        </if>
</div>
</body>
<script>
    $(document).on('click', '.tdBtn', function () {
        var answer = $('.block').val();
        var id = $('.leave_id').text();
        $.ajax({
            type: "POST",
            url: "{:U('leave/reply_do')}",
            dataType: "json",
            data: {answer: answer, id: id},
            success: function (msg) {
                if (!msg) {
                    alert("回复失败");
                } else {
                    $('.answer').append(msg.answer);
                    // $('.con').remove();
                    $('.con').empty();
                }
            }
        });
    })
</script>
</html>